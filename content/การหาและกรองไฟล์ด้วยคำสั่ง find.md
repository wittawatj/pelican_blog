Title: การหาและกรองไฟล์ด้วยคำสั่ง find 
Date: 2012-06-15 02:54:09
Tags: linux, ubuntu 
Slug: การหาและกรองไฟล์ด้วยคำสั่ง find 


คำสั่ง find เป็นคำสั่งพื้นฐานใน linux เพื่อเอาไว้หาไฟล์ต่างๆ โดยสามารถใส่เงื่อนไขในการหาได้หลากหลาย เช่น กำหนดขนาดไฟล์, ชื่อไฟล์, เวลาที่แก้ไขล่าสุด เป็นต้น นอกจากนี้ที่มีประโยชน์คือเราสามารถบอกได้ด้วยว่าให้ทำอะไรกับไฟล์ที่เจอ เช่น อาจจะให้คัดลอกไปไว้อีกที่ เป็นต้น โพสนี้อาจจะไม่คลุมการใช้งาน find ทั้งหมด แต่ตั้งใจเพื่อให้เป็นโพสต่อจาก <a title="กู้ข้อมูลที่ลบไปแล้วจาก iphone โดยใช้ Ubuntu" href="http://wittawat.com/blog/?p=306">การกู้ข้อมูลบน iphone</a> (คูณ Mayui ถามเข้ามา) หลังจากที่ได้ image file ของ iphone มาแล้วใช้ photorec กู้ได้ไฟล์มาเยอะมากแล้ว

ให้

[bash]/path/to/src/[/bash]

แทน path ของ folder ต้นทาง และให้

[bash]/path/to/dest/[/bash]

แทน path ของ folder ปลายทางละกัน เปลี่ยนเป็น path ที่ถูกต้องก่อนใช้งานด้วย ต่อไปนี้เป็นตัวอย่างการใช้งาน
<h3>หาไฟล์ทั้งหมดที่ลงท้าย .JPG ในโฟลเดอร์ต้นทาง</h3>
[bash]find /path/to/src/ -type f -name &quot;*.JPG&quot;[/bash]

แล้วจะได้ชื่อไฟล์ทั้งหมดออกมา ตรง .JPG นี่ต้องดูเรื่องตัวเล็กตัวใหญ่ด้วย .JPG กับ .jpg จะให้ผลไม่เหมือนกัน
<h3>หาไฟล์ .JPG ทั้งหมดที่มีขนาดใหญ่กว่า 1MB</h3>
[bash]find /path/to/src/ -type f -name &quot;*.JPG&quot; -size +1M[/bash]

แน่นอนว่าเลข 1M เปลี่ยนเป็นขนาดอื่นที่อยากหาได้ หรือถ้าอยากได้แค่ 500KB ก็ใช้ +500k (ใช้ k ตัวเล็ก) และจริงๆแล้วตรง + นี่เปลี่ยนเป็น - ได้จะใช้หาไฟล์ที่มีขนาดเล็กกว่าขนาดที่กำหนด
<h3>หาไฟล์ .JPG ทั้งหมดที่มีขนาดใหญ่กว่า 1MB แล้ว copy ทั้งหมดที่เจอไปไว้ที่โฟลเดอร์ปลายทาง</h3>
[bash]find /path/to/src/ -type f -name &quot;*.JPG&quot; -size +1M -exec cp -v {} /path/to/dest/ \;[/bash]

หรือจะแบบนี้ก็ได้ให้ผลเหมือนกัน

[bash]find /path/to/src/ -type f -name &quot;*.JPG&quot; -size +1M | xargs cp -v -t /path/to/dest/ [/bash]

ตรง | นี่ไม่ใช่ตัวแอลหรือตัวไอ แต่เป็นขีดตั้งอยู่ด้านบนของปุ่ม enter

ถ้าข้อมูลใหญ่มาก copy ไม่ไหวจะใช้วิธีย้ายไปเลยก็ได้ก็ให้เปลี่ยน cp เป็น mv แล้วข้อมูลจะถูกย้าย คือจะไม่กินที่ แต่ต้องระวังว่าย้ายแล้วจะเอากลับมาไว้ที่เดิมไม่ได้ ควรระวัง

เพิ่มเติมคือ
<ul>
	<li>-type f แปลว่าให้หาไฟล์ (คือไม่ใช่โฟลเดอร์หรือไฟล์พวก device )</li>
	<li>โฟลเดอร์ปลายทางต้องไม่อยู่ในโฟลเดอร์ต้นทาง ควรอยู่คนละที่กันเลย ถ้าซ้อนกันอยู่จะมีปัญหาตอน copy</li>
	<li>ถ้าอยากหาชื่อแปลกๆเช่นเอาไฟล์ที่ขึ้นต้นด้วย _DSC แล้วลงท้ายด้วย .JPG ก็ใช้ -name "_DSC*.JPG" (เครื่องหมาย * แปลว่า "กี่ตัวอักษรก็ได้ อักษรอะไรก็ได้")</li>
</ul>
