Title: รวม text file หลายๆอันเป็นไฟล์เดียวเพื่อการค้นหา 
Date: 2012-08-20 14:24:13
Tags: linux 
Slug: รวม text file หลายๆอันเป็นไฟล์เดียวเพื่อการค้นหา 


วิธีรวม text file หลายๆอันเป็นอันเดียวใน Linux คือ

[bash] tail -n +1 f1.txt f2.txt .... &gt; all.txt [/bash]

จะได้ all.txt มาเป็นเนื้อหาทั้งหมดของทุกไฟล์รวมกัน ตรงรายการไฟล์ f1.txt, f2.txt ส่วนใหญ่จะใส่เป็น *.txt ส่วน -n +1 หมายถึงให้เริ่มจากบรรทัดที่ 1 ของไฟล์เป็นต้นไป จริงๆจะใช้ cat ก็ได้เพราะนั่นคือจุดประสงค์ของ cat แต่ที่ใช้ tail เพราะมันจะใส่ชื่อไฟล์เข้าไปให้ด้วย ก่อนเริ่มเนื้อหาไฟล์แต่ละอันจะมีข้อความประมาณนี้อยู่
<pre> ==&gt; f1.tx &lt;==</pre>
แล้วก็จะรู้ว่าต่อไปเป็นเนื้อหาของไฟล์ไหน
<h3>รวมไปทำไม ?</h3>
การรวมไฟล์แบบนี้มีประโยชน์ตอนอยากหา substring ในไฟล์หลายๆไฟล์ ยิ่งไฟล์มากยิ่งเห็นความเร็วที่เพิ่มขึ้น เช่นเวลากู้ไฟล์จาก harddisk ด้วย photorec จะได้ไฟล์มาเยอะมาก (หลักแสน) สมมติอยากหาไฟล์เดิมไฟล์หนึ่งแล้วเราจำได้ว่าไฟล์นั้นมีคำว่า "hello world" อยู่ เราก็ทำ

[bash] grep -n -i &quot;hello world&quot; all.txt[/bash]

-n แปลว่าให้แสดงหมายเลขบรรทัดด้วย -i แปลว่าให้หาแบบ case-insensitive พอได้เลขบรรทัดแล้วก็ไปเปิดดูแล้วหาชื่อไฟล์ต่อไป

จริงๆถ้าไม่รวมแล้วอยากหาตรงๆเลยก็

[bash] find path_to_folder  -type f -name &quot;*.txt&quot; | xargs grep -n -i &quot;hello world&quot; [/bash]

ก็ได้ แต่อย่างที่บอกคือถ้ามีไฟล์หลักแสน และอยากหาหลายทีด้วย วิธีนี้ช้ามาก แต่ถ้าไฟล์น้อยก็สะดวกกว่า
