Title: ความหมายของ $  ใน Haskell 
Date: 2013-05-23 13:24:18
Tags: haskell 
Slug: ความหมายของ $  ใน Haskell 


เป็นที่ทราบดีว่า $ (เครื่องหมาย dollar) ใน Haskell เอาไว้คั่น argument ต่างๆของ function ที่เขียนเรียงต่อๆกันเพื่อให้ Haskell evaluate ได้ถูกลำดับจากขวาไปซ้าย ตัวอย่างเช่น แทนที่จะเขียน

	abs ( sum (filter odd [1..10]) )


ก็ใช้แบบนี้แทน

	abs $ sum $ filter odd [1..10]


การใช้แบบนี้จึงทำให้สรุปว่า \$  เอาไว้คั่น function ที่เขียนเรียงๆกัน แต่ในมุมมองของระบบ $ จริงๆแล้วคืออะไรกันแน่ ? ถ้าลองเช็ค type ด้วย ghci ดู จะได้

<pre>Prelude> :t ($)
($) :: (a -> b) -> a -> b</pre>

ซึ่งบอกว่า (\$) คือ function (ซึ่งน่าแปลกใจ!) ที่รับ function หนึ่ง (a -> b) กับค่าที่มี type a แล้วให้ค่าที่มี type b จริงๆแล้ว (\$) ไม่ได้ทำอะไรเลย มันมีหน้าที่รับ function กับรับ input หนึ่งแล้วส่ง input นั้นไปที่ function ให้ function ทำอะไรบางอย่าง ตัวอย่างเช่น

	($) sqrt 9

คือรับ function หา square root กับ input 9 แล้วก็เรียก sqrt 9 ให้เราซึ่งจะได้ 3.0 การเอามาใช้แบบนี้จะทำให้เกิดคำถามว่าแล้วจะทำไปทำไม ทำไมไม่เขียน sqrt 9 ไปเลย ไม่เห็นต้องผ่าน $ เลย? มันมีประโยชน์อย่างที่กล่าวไปว่ามันเอาไว้คั่นได้ ถ้าเอามาใช้แบบ infix ซึ่งก็คือ

	sqrt $ 9


และนี่คือเหตุผลว่าทำไมมันคั่นได้ จริงๆมันไม่ได้คั่น มันก็แค่รับ function กับ input แล้วส่งไป evaluate ให้ ถ้าเข้าใจตรงนี้ก็จะเอามาใช้แบบนี้ได้

	($ 3) (+4)

(\$ 3) เป็นการใช้แบบ infix โดยที่ argument ที่สองเป็น 3 แล้ว ฉะนั้น ($ 3) จะเป็น function ที่รับ function f แล้ว evaluate f(3) จากตัวอย่าง code ทีแล้วจะได้ 7 เพราะ (+4) คือ function ที่รับเลขแล้วเอามาบวก 4 การใช้แบบนี้มีประโยชน์เมื่อเอาไปใช้ร่วมกับ map เช่น

	map ($ 3) [(^2), (+4), (*5)]


ซึ่งจะได้
	[9,7,15]

 <a href="http://learnyouahaskell.com/higher-order-functions">แหล่งที่มา</a>
